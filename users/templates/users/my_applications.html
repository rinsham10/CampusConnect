<!-- users/templates/users/my_applications.html -->
{% extends "users/career_base.html" %}

{% block career_content %}
<div class="career-main-content">
    <div class="header">
        <h1>Your Applications</h1>
        <p class="text-secondary">Tracking {{ total_applications }} application{{ total_applications|pluralize }}</p>
    </div>

    <!-- Search Bar Form -->
    <form method="GET" action="{% url 'my-applications' %}">
        <div class="filter-bar">
            <input type="text" class="form-control" name="q" placeholder="Search by company, job title, or application ID..." value="{{ search_query }}">
            <button type="submit" class="btn btn-primary">Search</button>
        </div>
    </form>

    <!-- Application Grid -->
    <div class="application-grid">
        {% for app in applications %}
        <div class="application-card">
            <div class="app-card-header">
                <div class="app-card-logo">{{ app.job.company|first }}</div>
                <div>
                    <div class="app-company-name">{{ app.job.company }}</div>
                    <div class="app-company-tagline">Company</div>
                </div>
            </div>
            <div class="app-card-body">
                <h5>{{ app.job.title }}</h5>
                <ul class="app-card-details">
                    <li><i class="fas fa-user-check"></i>{{ app.status }}</li>
                    <li><i class="far fa-calendar-alt"></i>Applied {{ app.applied_date|date:"M j, Y" }}</li>
                    <li><i class="fas fa-id-card"></i>ID: {{ app.id }}</li>
                    <li>
                        {% if app.resume %}
                            <i class="far fa-file-alt"></i>
                            <a href="{{ app.resume.file.url }}" target="_blank">View Resume <i class="fas fa-external-link-alt fa-xs"></i></a>
                        {% else %}
                             <i class="far fa-file-alt"></i>No Resume Attached
                        {% endif %}
                    </li>
                </ul>
            </div>
            <div class="app-card-footer">
                <a href="{% url 'job-detail' app.job.id %}" class="btn btn-dark">View Job Details <i class="fas fa-arrow-right fa-xs"></i></a>
            </div>
        </div>
        {% empty %}
            <div class="col-12 w-100">
                <p class="text-center text-secondary mt-5">
                    {% if search_query %}
                        No applications found matching your search.
                    {% else %}
                        You have not applied for any jobs yet.
                    {% endif %}
                </p>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}